{% extends 'EnmashPagesBundle:Base:public_base.html.twig' %}

    {% block customcss %}
        {{ parent() }}
        <link rel="stylesheet" href="//blueimp.github.io/Gallery/css/blueimp-gallery.min.css">
        <link rel="stylesheet" href="{{ asset('vendor/blueimp-bootstrap-image-gallery/css/bootstrap-image-gallery.min.css') }}">
    {% endblock %}

    {% block jumbotron %}
        {% include 'EnmashPagesBundle:Pages:Blocks/stores/bigmap.html.twig' with {'storeType' : constant('Enmash\\Bundle\\StoreBundle\\Entity\\Store::RETAIL_TYPE')} %}
    {% endblock %}

    {% block content %}

        {% include 'EnmashPagesBundle:Pages:Blocks/gallerymodal.html.twig' %}

        {% for store in stores %}
            {% include 'EnmashPagesBundle:Pages:Blocks/stores/store.html.twig' with {'store': store} %}
        {% endfor %}

    {% endblock %}

    {% block js %}
        {{ parent() }}
        <script src="//blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min.js"></script>
        <script src="{{ asset('vendor/blueimp-bootstrap-image-gallery/js/bootstrap-image-gallery.min.js') }}"></script>
        <script type="text/javascript">

            $(document).ready(function(){

                var mapInfo = null;

                if (mapInfo == null) {

                    var iconPath = $('#bigmap').attr('data-icon-path');

                    $.ajax({
                        method: 'POST',
                        data: {
                            'type': $('#bigmap').attr('data-type')
                        },
                        url: $('#bigmap').attr('data-path'),
                        success: function(data) {
                            mapInfo = initializeBigMap(data, iconPath);
                        }
                    });
                }

                //show store on map
                $("a.show-store-on-map").click(function(e){
                    e.preventDefault();
                    var storeId = $(this).attr('data-store-id');

                    if (!mapInfo.map) {
                        alert('Map is not available');
                        return;
                    }
                    for (var i = 0; i < mapInfo.markers.length; i++) {
                        if (mapInfo.markers[i].point.pointId == storeId) {
                            mapInfo.map.panTo(mapInfo.markers[i].point.getPosition());
                            mapInfo.map.setZoom(15);
                            new google.maps.event.trigger(mapInfo.markers[i].point, 'click');
                            var body = $("html, body");
                            body.animate({scrollTop:0}, '500', 'swing');
                        }
                    }
                });

            });

        </script>
    {% endblock %}